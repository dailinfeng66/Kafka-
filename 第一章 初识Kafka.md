## 消息和批次

+ 为了提高效率，消息是分批次写入Kafka的，批次就是一组消息，所以每次是分批次去传输消息的，而不是来一条消息就传送一条消息。

##  主题和分区

+ Kafka的消息通过主题进行分类，主题就类似于数据库的一张表。
+ 主题被分为若干个分区，一个分区就是一个提交日志，消息以追加的方式写入分区。
+ 一个主题一般包含若干个分区，因此无法在整个主题内保证消息的顺序，但可以保证消息在单个分区内的顺序。
+ 分区可以分布在不同的服务器上，也就是说一个主题可以横跨多个服务器。

## 生产者和消费者

+ 一般情况下一个消息会被发布到一个特定的主题上。生产者默认是把消息负载均衡的发布到主题的所有分区上。
+ 生产者也可以将消息发布到一个特定的分区，这通常是通过消息键和分区器来实现的。这样可以保证包含同一个键的消息会被写到同一个分区上。
+ 生产者也可以使用自定义的分区器，根据不同的业务规则将消息映射到分区。
+ 消费者可以订阅一个或多个主题，并按照消息生成的顺序读取他们。
+ 消费者通过检查消息的偏移量（offset）来区分已经读取过的消息。
+ 偏移量（offset）是一种元数据，是一个递增的整数，在给定的分区里，每个消息的偏移量都是唯一的。
+ 在创建消息的时候Kafka会把偏移量添加到消息里，消费者会把最后读取的消息偏移量保存到zookeeper或kafka这样就可以保证消费者关闭或重启之后读取状态不变。

## broker 和集群

+ 一个独立的Kafka服务器被称为broker，broker接收来自生产者的消息，为消息设置偏移量，并提交消息到磁盘存储。



